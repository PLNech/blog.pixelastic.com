<!doctype html>
<html class="no-js" lang="en-us">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>
     Pixelastic 
  </title>
  <meta name="description" content="Personal blog of Tim Carry. Posting mostly on tech-related stuff.">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="/public/css/forms.css">

  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>

<body class="layout-reverse theme-base-0b">
  <div class="sidebar">
    <div class="container">
      <div class="sidebar-about">
        <h1><a href="/index.html">Pixelastic</a></h1>
        <p class="lead">Personal blog of Tim Carry. Posting mostly on tech-related stuff.</p>
      </div>

      <ul class="sidebar-nav">
        <li class="sidebar-nav-item active">
          <a href="/">Home</a>
        </li>
        <li class="sidebar-nav-item">
          <a href="/about/">About</a>
        </li>
        <li class="sidebar-nav-item">
          <a href="/archive/">Archive</a>
        </li>
      </ul>
      <div class="sidebar-footer">Website code available on <a href="https://github.com/pixelastic/blog.pixelastic.com">GitHub</a></div>
    </div>
  </div>

  <div class="content container">
    <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2010/08/21/prevent-fouc-gracefully-degrade-jquery-ui-tabs/">
        How to prevent a FOUC but still gracefully degrade the jQuery UI tabs
      </a>
    </h1>

    <span class="post-date">21 Aug 2010</span>

    <p>I finally managed to fix something that was bugging me for a very long time.
I&#39;m talking about the jQuery UI tabs.</p>

<p>They are pretty useful actually, but I always hated that FOUC they produce.
For one split second, you&#39;ll see all your tabs content, then they&#39;ll be neatly
re-arranged in tabs.</p>

<p>What I want are my tabs displayed correctly right away, on first load.</p>

<h2>First, the markup</h2>

<p>Here&#39;s a typical tabs markup :</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;tabs&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ul&gt;</span>
        <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;#firstTab&quot;</span><span class="nt">&gt;</span>First tab<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
        <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;#secondTab&quot;</span><span class="nt">&gt;</span>Second tab<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;tabPanel&quot;</span> <span class="na">id=</span><span class="s">&quot;firstTab&quot;</span><span class="nt">&gt;</span>
        First tab content
    <span class="nt">&lt;/div&gt;</span>
   
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;tabPanel&quot;</span> <span class="na">id=</span><span class="s">&quot;secondTab&quot;</span><span class="nt">&gt;</span>
        Second tab content
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div>
<h2>CSS to hide all tabs if Javascript is disabled</h2>

<p>If your Javascript is disabled, so will jQuery UI. We will then hide the
<code>&lt;ul&gt;</code> because it serves no purpose here. We will only show it if js is
enabled</p>
<div class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.tabs</span> <span class="nt">ul</span> <span class="p">{</span> <span class="k">display</span><span class="o">:</span><span class="k">none</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.js</span> <span class="nc">.tabs</span> <span class="nt">ul</span> <span class="p">{</span> <span class="k">display</span><span class="o">:</span><span class="k">block</span><span class="p">;</span> <span class="p">}</span>
</code></pre></div>
<h2>Applying jQuery UI tabs</h2>

<p>By doing a<code>$(&#39;.tabs&#39;).tabs();</code> jQuery UI will treat your <code>&lt;ul&gt;</code> as your tab
menu and all your <code>.tabPanel</code> as their corresponding contents. It will hide
all your panels, except for the first one. It does so by adding a<code>.ui-tabs-
panel</code> class to every <code>.tabPanel</code> as well as a <code>.ui-tabs-hide</code> to every panel
it hides.</p>

<p>Right now, you should add another CSS rule to hide the unused panels :</p>
<div class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.ui-tabs-hide</span> <span class="p">{</span> <span class="k">display</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span> <span class="p">}</span>
</code></pre></div>
<p>But if you look at your page now, you&#39;ll see all your tabs content before they
get hidden. That is the FOUC I was talking about. The jQuery UI documentation
indicate that to remove it, you should directly add the <code>.ui-tabs-hide</code> class
to panels you&#39;ll want to hide.</p>

<p>As also pointed in the doc, it will not gracefully degrade because users
without Javascript won&#39;t even be able to see your other tabs. Also, it asks
you to add server-side logic (HTML markup with jQuery specific classes) for
something that should be handled entirely client-side.</p>

<h2>Removing the FOUC while gracefully degrade</h2>

<p>Ok, so what I did was writing two simple rules that will directly hide all
unused panels while still displaying the active one, even before jQuery UI
takes action.</p>
<div class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.js</span> <span class="nc">.tabPanel</span> <span class="o">+</span> <span class="nc">.tabPanel</span> <span class="p">{</span> <span class="k">display</span><span class="o">:</span><span class="k">none</span><span class="p">;}</span>
</code></pre></div>
<p>That way, no FOUC, and users without Javascript still see all the content.
Unfortunatly, if you now try clicking on your tabs, you&#39;ll see that nothing
happens and you get stuck with your default panel always visible.</p>

<h2>Fixing the jQuery UI tabs</h2>

<p>As jQuery will add new classes to my elements, I&#39;ll just have to write more
specific rules that use those classes. Here&#39;s the little piece of logic I came
up with :</p>
<div class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.js</span> <span class="nc">.tabPanel.ui-tabs-panel</span> <span class="p">{</span> <span class="k">display</span><span class="o">:</span><span class="k">block</span><span class="p">;}</span>
<span class="nc">.js</span> <span class="nc">.tabPanel.ui-tabs-panel.ui-tabs-hide</span> <span class="p">{</span> <span class="k">display</span><span class="o">:</span><span class="k">none</span><span class="p">;}</span>
</code></pre></div>
<p>All the jQuery panels are shown, except for the one hidden by jQuery. All
those rules being more and more specific, they will get applied once the tabs
are activated but still override the previous <code>display:</code> declarations.</p>

<h2>Conclusion</h2>

<p>This is how I fixed an issue that was bugging me for years. Unfortunatly the
CSS rules being dependent on the markup used, I haven&#39;t yet been able to write
them in a global form that could be added to the main jQuery UI css files.</p>

<p>*[FOUC]: Flash Of Unstyled Content</p>


    <div class="tag-list">
      
        <a href="/tags/jquery-ui">#jquery-ui</a>
      
        <a href="/tags/tabs">#tabs</a>
      
        <a href="/tags/jquery">#jquery</a>
      
        <a href="/tags/graceful-degradation">#graceful-degradation</a>
      
        <a href="/tags/javascript">#javascript</a>
      
        <a href="/tags/css">#css</a>
      
        <a href="/tags/fouc">#fouc</a>
      
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2010/08/21/css-for-javascript-enabled-browsers/">
        CSS for Javascript enabled browsers
      </a>
    </h1>

    <span class="post-date">21 Aug 2010</span>

    <p>In a previous post I was wondering if my way of loading js-specific CSS rules
was right. I was loading a specific css file for js overrides.</p>

<p>This allow for lighter stylesheets for users without Javascript (they won&#39;t
load useless rules), but also resulted in slower rendering for other users
because they needed to load two stylesheets instead of one.</p>

<p>After much pondering, I now think that loading all the rules in one stylesheet
is the way to go.</p>

<p>In addition with the number of request mentionned, keeping all your rules in
the same file is much more easier to maintain. Js-specific rules aren&#39;t that
big either so the small additional bytes are usually better than a full http
request.</p>

<p>I now prefix all my Javascript rules by <code>.js</code>. I add a <code>js</code> class to the <code>html
</code>element directly from the <code>head</code>, this helps in preventing any FOUC that may
occur because we add the class before the <code>body</code> rendering.</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;script&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">className</span><span class="o">+=</span><span class="s1">&#39; js&#39;</span><span class="p">;</span><span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
</code></pre></div>

    <div class="tag-list">
      
        <a href="/tags/css">#css</a>
      
        <a href="/tags/javascript">#javascript</a>
      
        <a href="/tags/performance">#performance</a>
      
        <a href="/tags/html">#html</a>
      
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2010/08/19/text-emboss-in-css/">
        Text emboss in CSS
      </a>
    </h1>

    <span class="post-date">19 Aug 2010</span>

    <p>I know only two _unperfect _ways of displaying an emboss text in CSS. As we
can&#39;t use inset shadows with <code>text-shadow</code>, unlike <code>box-shadow</code>, we have to
resort to other hacky ways.</p>

<p>Let me show you what can be done.</p>

<h2>Simulate it with an optical illusion</h2>

<p>Instead of creating a real inner shadow, you can just create an optical
illusion by adding the correct shadow to make the viewer believe your text is
embossed.</p>

<p>If you have dark text, just add a subtle white shadow at the bottom, while if
you have light text, just add a subtle black one at the top.</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&quot;emboss light&quot;</span><span class="nt">&gt;</span>Lorem ipsum<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&quot;emboss dark&quot;</span><span class="nt">&gt;</span>Lorem ipsum<span class="nt">&lt;/a&gt;</span>
</code></pre></div><div class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.emboss</span> <span class="p">{</span> <span class="k">font-size</span><span class="o">:</span><span class="m">1.2em</span><span class="p">;</span> <span class="k">padding</span><span class="o">:</span><span class="m">50px</span><span class="p">;</span> <span class="k">font-weight</span><span class="o">:</span><span class="k">bold</span><span class="p">;</span> <span class="k">background</span><span class="o">:</span><span class="m">#0A539C</span><span class="p">;</span> <span class="k">display</span><span class="o">:</span><span class="k">block</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.light</span> <span class="p">{</span> <span class="k">color</span><span class="o">:</span><span class="m">#FFFFFF</span><span class="p">;</span> <span class="k">text-shadow</span><span class="o">:</span><span class="m">0px</span> <span class="m">-1px</span> <span class="m">0px</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span><span class="m">0</span><span class="o">,</span><span class="m">0</span><span class="o">,</span><span class="m">0</span><span class="o">.</span><span class="m">9</span><span class="p">);</span> <span class="p">}</span>
<span class="nc">.dark</span> <span class="p">{</span> <span class="k">color</span><span class="o">:</span><span class="m">#000000</span><span class="p">;</span> <span class="k">text-shadow</span><span class="o">:</span><span class="m">0px</span> <span class="m">1px</span> <span class="m">0px</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span><span class="m">255</span><span class="o">,</span><span class="m">255</span><span class="o">,</span><span class="m">0</span><span class="o">.</span><span class="m">1</span><span class="p">);</span> <span class="p">}</span>
</code></pre></div>
<p>I added an <code>emboss</code>class to more easily spot the effect, but the important
code is in the <code>light</code>and <code>dark</code>rules.</p>

<h2>Add an almost transparent layer</h2>

<p>For this second solution we will simply add a second layer with the exact same
text above the first text. Just slightly moving it and making it partly
transparent.</p>

<p>You could add twice your element in your markup, but that would be bad for
accesibility as well as SEO, so we&#39;ll instead use the <code>:before</code> pseudo-class.</p>

<p>We can set the <code>:before</code> content using the <code>content:</code> property, and we can
also use the<code>attr()</code> method to get the content of one of our element&#39;s
attributes. We just need to put the exact same text in one of our attributes
and we&#39;re good to go.</p>

<p>This can be easily done with a link and its <code>title</code>attribute.</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&quot;emboss lightAgain&quot;</span> <span class="na">title=</span><span class="s">&quot;Lorem ipsum&quot;</span><span class="nt">&gt;</span>Lorem ipsum<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&quot;emboss darkAgain&quot;</span> <span class="na">title=</span><span class="s">&quot;Lorem ipsum&quot;</span><span class="nt">&gt;</span>Lorem ipsum<span class="nt">&lt;/a&gt;</span>
</code></pre></div><div class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.lightAgain</span> <span class="p">{</span> <span class="k">color</span><span class="o">:</span><span class="m">#FFFFFF</span><span class="p">;</span> <span class="k">position</span><span class="o">:</span><span class="k">relative</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.lightAgain</span><span class="nd">:before</span> <span class="p">{</span>
<span class="err"> </span> <span class="k">content</span><span class="o">:</span> <span class="n">attr</span><span class="p">(</span><span class="n">title</span><span class="p">);</span>
<span class="err"> </span> <span class="k">position</span><span class="o">:</span><span class="k">absolute</span><span class="p">;</span>
<span class="err"> </span> <span class="k">color</span><span class="o">:</span><span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span><span class="m">0</span><span class="o">,</span><span class="m">0</span><span class="o">,</span><span class="m">0</span><span class="o">.</span><span class="m">1</span><span class="p">);</span>
<span class="err"> </span> <span class="k">top</span><span class="o">:-</span><span class="m">1px</span><span class="p">;</span>
<span class="err"> </span> <span class="k">left</span><span class="o">:-</span><span class="m">1px</span><span class="p">;</span>
<span class="err"> </span> <span class="k">padding</span><span class="o">:</span><span class="m">50px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.darkAgain</span> <span class="p">{</span> <span class="k">color</span><span class="o">:</span><span class="m">#000000</span><span class="p">;</span> <span class="k">position</span><span class="o">:</span><span class="k">relative</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.darkAgain</span><span class="nd">:before</span> <span class="p">{</span>
<span class="err">  </span> <span class="k">content</span><span class="o">:</span> <span class="n">attr</span><span class="p">(</span><span class="n">title</span><span class="p">);</span>
<span class="err">  </span> <span class="k">position</span><span class="o">:</span><span class="k">absolute</span><span class="p">;</span>
<span class="err">  </span> <span class="k">color</span><span class="o">:</span><span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="o">,</span><span class="m">255</span><span class="o">,</span><span class="m">255</span><span class="o">,</span><span class="m">0</span><span class="o">.</span><span class="m">1</span><span class="p">);</span>
<span class="err">  </span> <span class="k">top</span><span class="o">:</span><span class="m">1px</span><span class="p">;</span>
<span class="err">  </span> <span class="k">left</span><span class="o">:</span><span class="m">1px</span><span class="p">;</span>
<span class="err">  </span> <span class="k">padding</span><span class="o">:</span><span class="m">50px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>The effect is much better with this technique but it also has it share of
drawback :</p>

<ul>
<li>You have to write your content twice, once in the element and once in an attribute</li>
<li>You have to copy all your <code>padding</code>rules in the <code>:before</code>element or it won&#39;t get correctly positionned</li>
<li>You can&#39;t select the text with this effect</li>
</ul>

<p>Hope those two little techniques helped someone, anyway.</p>


    <div class="tag-list">
      
        <a href="/tags/after">#after</a>
      
        <a href="/tags/css">#css</a>
      
        <a href="/tags/text-shadow">#text-shadow</a>
      
        <a href="/tags/emboss">#emboss</a>
      
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2010/08/19/how-to-hide-show-elements-based-on-javascript/">
        How to hide/show elements based on Javascript
      </a>
    </h1>

    <span class="post-date">19 Aug 2010</span>

    <p>Sometimes you have a really great design with some really fancy Javascript
goodness, like drag&#39;n&#39;drop and other shiny Ajaxy stuff.</p>

<p>But when you browse the website with Javascript disabled, none of that works
and you end up with interface elements that should&#39;nt be here because they do
not work.</p>

<p>In those case, you&#39;d rather display a nice message to your user, telling him
that he can&#39;t use the feature withou Javascript enabled.</p>

<h2>But how do you do that ?</h2>

<p>Well, I myself load two different stylesheets. Remember that your website
should be working without Javascript, this is just the last layer you add.</p>

<p>My default stylesheet will load all the rules for when Javascript is not
enabled. No fancy <code>cursor:move</code> here.</p>

<p>Then I load a second stylesheet using Javascript, using <code>document.write()</code> in
the <code>&lt;head&gt;</code>. And that&#39;s in this one that I write rules that overload the
previous one. I add every styling that deals with Javascript-enabled features
here.</p>

<h2>Limitations</h2>

<p>I may be changing the way I load the JS stylesheet in the future. I don&#39;t
really like relying on <code>document.write</code> because it is <em>evil</em>. I also don&#39;t
like the idea of getting one extra request.</p>

<p>I could add a <code>js</code> class to my body element (like
<a href="http://www.modernizr.com/">modernizr</a> does with all its CSS3 properties) and
then target elements by prepending <code>.js</code> to the rule.</p>

<p>But it means adding rules in my main CSS file for users without JS that will
still be downloading those extra useless bytes.</p>

<p>I haven&#39;t yet figured which way was the best (or should I say, the worst)</p>

<h2>Convenient methodes</h2>

<p>Whatever way you choose, one thing that really helped me was two real simple
classes : <code>jsOn</code>and <code>jsOff</code>that I add to elements.</p>

<p>Elements with <code>jsOn</code>will only be visible if Javascript is enabled and hidden
otherwise, while element with <code>jsOff</code>will do the opposite.</p>

<p>Assuming you mark your body element with a <code>js</code> class if Javascript is
enabled, here&#39;s how to do it :</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="p">.</span><span class="nx">jsOn</span> <span class="p">{</span> <span class="nx">display</span><span class="o">:</span><span class="nx">none</span><span class="p">;</span> <span class="p">}</span>
<span class="p">.</span><span class="nx">js</span> <span class="p">.</span><span class="nx">jsOn</span> <span class="p">{</span> <span class="nx">display</span><span class="o">:</span><span class="nx">block</span><span class="p">;</span>
<span class="p">.</span><span class="nx">jsOff</span> <span class="p">{</span> <span class="nx">display</span><span class="o">:</span><span class="nx">block</span><span class="p">;</span>
<span class="p">.</span><span class="nx">js</span> <span class="p">.</span><span class="nx">jsOff</span> <span class="p">{</span> <span class="nx">display</span><span class="o">:</span><span class="nx">none</span><span class="p">;</span>
</code></pre></div>
<p>Hope all that helps at least someone.</p>


    <div class="tag-list">
      
        <a href="/tags/css">#css</a>
      
        <a href="/tags/javascript">#javascript</a>
      
        <a href="/tags/performance">#performance</a>
      
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2010/08/17/corrupted-strings-when-using-strtolower/">
        Corrupted strings when using strtolower()
      </a>
    </h1>

    <span class="post-date">17 Aug 2010</span>

    <p><em>Little blog post at 5am, I&#39;ll try to make it very short, I need some sleep.</em></p>

<p>To avoid getting corrupted string results when calling <code>strtolower</code>on UTF8
strings, you can call <code>mb_strtolowe</code>r instead. The <code>mb_*</code> functions are aware
of the utf8 encoding.</p>

<p>Unfortunatly, sometime you just can&#39;t, because the call is made in the cakePHP
core (<code>Inflector</code>). Defining a <code>CTYPE</code>locale for your whole app may be a
better solution.</p>

<p>Just add a <code>setlocale(LC_CTYPE, &#39;C&#39;);</code> in your app and all your utf8 strings
will correctly work with string functions.</p>

<p>Just note that on Windows, calling setlocale will change the locale for all
threads, not just the one where PHP is running. This may cause unexpected
results.</p>


    <div class="tag-list">
      
        <a href="/tags/lc-ctype">#lc-ctype</a>
      
        <a href="/tags/setlocale">#setlocale</a>
      
        <a href="/tags/utf8">#utf8</a>
      
        <a href="/tags/php">#php</a>
      
    </div>
  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page26">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page24">Newer</a>
    
  
</div>

  </div>

</body>

</html>
