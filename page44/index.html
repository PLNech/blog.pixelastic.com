<!doctype html>
<html class="no-js" lang="en-us">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>
     Pixelastic 
  </title>
  <meta name="description" content="Personal blog of Tim Carry. Posting mostly on tech-related stuff.">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="/public/css/forms.css">

  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>

<body class="layout-reverse theme-base-0b">
  <div class="sidebar">
    <div class="container">
      <div class="sidebar-about">
        <h1><a href="/index.html">Pixelastic</a></h1>
        <p class="lead">Personal blog of Tim Carry. Posting mostly on tech-related stuff.</p>
      </div>

      <ul class="sidebar-nav">
        <li class="sidebar-nav-item active">
          <a href="/">Home</a>
        </li>
        <li class="sidebar-nav-item">
          <a href="/about/">About</a>
        </li>
        <li class="sidebar-nav-item">
          <a href="/archive/">Archive</a>
        </li>
      </ul>
      <div class="sidebar-footer">Website code available on <a href="https://github.com/pixelastic/blog.pixelastic.com">GitHub</a></div>
    </div>
  </div>

  <div class="content container">
    <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2010/01/10/safari-input-focusing-problem/">
        Safari input focusing problem
      </a>
    </h1>

    <span class="post-date">10 Jan 2010</span>

    <p>I just ran into a strange behavior on Safari 3 (Win). I&#39;m not quite sure what
caused this problem, but I tracked it down to one CSS rule.</p>

<p>The thing was that I had an input field that moved whenever I tried to focus
it. It jump 3 pixels up whenever I gave him focus. I had never seen that
before.</p>

<p>I finally managed to track it down to the padding:2px 0px 5px 0px;
declaration. I exploded it in four (-top, -right, -bottom and -left) and it
seemed that it was the padding-bottom:0px that cause the bug.</p>

<p>I finally rewrote my css (in three lines instead of one) and moved to other
things.</p>

<p>I post it here as a reminder, and hope it could help someone.</p>


    <div class="tag-list">
      
        <a href="/tags/css">#css</a>
      
        <a href="/tags/safari">#safari</a>
      
        <a href="/tags/input">#input</a>
      
        <a href="/tags/bug">#bug</a>
      
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2009/12/16/freelancing-i-miss-you/">
        Freelancing, I miss you
      </a>
    </h1>

    <span class="post-date">16 Dec 2009</span>

    <p>Well, it&#39;s been one month and a half now that I&#39;ve put my freelance activites
on hold. I&#39;m in contract with a big company to develop an internal
application.</p>

<p>The purpose of the application is really interesting, the guy I&#39;m working with
is too, but the language I have to use as well as the all-administrative thing
of big companies like that is... well... let&#39;s just say I LOVE being a
freelancer PHP developper.</p>

<p>One more month and a half and it will be over. I allready have learn a lot
about metadatas in general and particularly Exif, Iptc and XMP. I&#39;ve also
learned a little about Coldfusion. Enough to know that I won&#39;t work with that
language again, unless I&#39;m forced too.</p>

<p>In the remaining week, I&#39;ll also learn EXTJs, and this part seems promising. I
guess leaving jQuery and its easy syntax will be hard at first, but all the
data handling of EXTJs seems really powerful.</p>

<p>Anyway, when that contract will be over, I&#39;ll be back to Caracole and I have
so many ideas of features and whole websites that I want to create...</p>

<p>I would like to make the admin panel of Caracole the one thing an
administrator would have to check to see if everything is going well on its
website. I allready have an extended <code>PHPInfo()</code>highlighting possible
misconfiguration but I want to push that further by integrating Google
Analytics, checking the Gmail inbox associated as well as integrating the
PHPSec library.</p>

<p>In the future I also plan on creating a photography website for Street Art and
graffitis, with gelocalisation, metadatas saving of the author and place,
possibility to upload photo directly from a mobile phone, etc</p>

<p>The old ideas about my own personal website, a quizz website, or one for
rating driver&#39;s ed are still in my mind. Wait and see.</p>


    <div class="tag-list">
      
        <a href="/tags/xmp">#xmp</a>
      
        <a href="/tags/phpsec">#phpsec</a>
      
        <a href="/tags/php">#php</a>
      
        <a href="/tags/metadatas">#metadatas</a>
      
        <a href="/tags/iptc">#iptc</a>
      
        <a href="/tags/google-analytics">#google-analytics</a>
      
        <a href="/tags/gmail">#gmail</a>
      
        <a href="/tags/exif">#exif</a>
      
        <a href="/tags/coldfusion">#coldfusion</a>
      
        <a href="/tags/caracole">#caracole</a>
      
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2009/10/29/configuring-a-fr-with-dreamhost/">
        Configuring a .fr with Dreamhost
      </a>
    </h1>

    <span class="post-date">29 Oct 2009</span>

    <p>Hosting a website on a .fr is a little harder than a simple .com. The
<a href="http://www.afnic.fr/">Afnic</a> (registry for the .fr domains) makes a check
whenever you change the DNS of your domain to make sure the new DNS can accept
the domain.</p>

<p>They run a tool named <a href="http://www.zonecheck.fr/">ZoneCheck</a> to do that. This
tool will request the new DNS server to test if they can accept the .fr. The
problem is that they make a request on the port 53, which is not open on
Dreamhost and thus the test fail and the Afnic refuse to let you change your
DNS.</p>

<p>The alternative is to not change you DNS, and keep the default one of your
registrar, but manually edit the zones and copy the zones defined in your
dreamhost panel (In Domains &gt; Your domain &gt; DNS, at the bottom of the page)
into your zones.</p>

<p>The most important part is modifying the default <code>A</code> entry to the IP of your
dreamhost server. You should do the same for the <code>www A</code>entry to.</p>

<p>Create a <code>mysql A</code>entry and a <code>ftp A</code> entry if you want to use both
<code>ftp.domain.com</code> and <code>mysql.domain.com</code>.</p>

<p>I also changed the MX record to the google one, as well as creating a CNAME
webmail.</p>


    <div class="tag-list">
      
        <a href="/tags/zonecheck">#zonecheck</a>
      
        <a href="/tags/gandi">#gandi</a>
      
        <a href="/tags/dreamhost">#dreamhost</a>
      
        <a href="/tags/afnic">#afnic</a>
      
        <a href="/tags/fr">#fr</a>
      
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2009/10/28/using-both-php4-and-php5-with-easyphp/">
        Using both php4 and php5 with Easyphp
      </a>
    </h1>

    <span class="post-date">28 Oct 2009</span>

    <p>I&#39;m mostly developing on my Windows machine, using EasyPHP (combining Apache,
Mysql and PHP). Each version of EasyPHP is bundled with a specific version of
php.</p>

<p>I&#39;m now almost exclusively developping with the sweetness of php5, but I still
have from time to time to refactor a piece of code on an legacy app running on
php4.</p>

<p>I have finally found a way to make specific website to work on php4 instead of
php5 using the same install of EasyPHP.</p>

<p>The key is : running php4 as a cgi script.</p>

<p>I&#39;ve finally found a way, by installing php4 as a cgi.</p>

<ul>
<li>Download the <a href="http://fr.php.net/releases/">Windows binary of the version</a> you want to emulate.</li>
<li>Create a subdirectory named php4 in your EasyPHP/apache/cgi-bin/ directory</li>
<li>Extract the php.exe, php4ts.dll, sapi/php4apache.dll, php.ini-recommended and the extensions directory in this new directory</li>
<li>Rename php.ini-recommended to php.ini (this will be the php.ini used with php4)</li>
<li>Edit your apache config file and add the line ScriptAlias /php4/ &quot;${path}/apache/cgi-bin/php4/&quot; after the allready defined ScriptAlias (~line 379)</li>
<li>Create a new virtualhost for the website you would like to run in php4. Mine is as follow :</li>
</ul>
<div class="highlight"><pre><code class="language-apache" data-lang="apache"><span class="nt">&lt;Virtualhost</span> <span class="s">*:80</span><span class="nt">&gt;</span>
 <span class="nb">ServerName</span> foobar
 <span class="nb">ServerAdmin</span> me@localhost
 <span class="nb">DocumentRoot</span> <span class="s2">&quot;${path}/www/foobar.com&quot;</span>

 <span class="nt">&lt;Directory</span> <span class="s">&quot;${path}/www/foobar.com&quot;</span><span class="nt">&gt;</span>
 <span class="nb">Options</span> Indexes FollowSymLinks Includes ExecCGI
 <span class="nb">AllowOverride</span> <span class="k">All</span>
 <span class="nb">Order</span> allow,deny
 <span class="nb">Allow</span> from <span class="k">all</span>
 <span class="nt">&lt;/Directory&gt;</span>

 <span class="nb">AddHandler</span> php4-script .php .html .htm
 <span class="nb">Action</span>     php4-script <span class="sx">/php4/php.exe</span>

 <span class="nt">&lt;/Virtualhost&gt;</span>
</code></pre></div>
<p>This means that all .php, .html and .htm file of this virtualhost will be
parsed by the php.exe file in our /cgi-bin/php4 directory.</p>

<p>Don&#39;t forget to edit this php.ini if you want to tweak things, and remember
that extensions for this version are in the copied extensions/ directory.</p>


    <div class="tag-list">
      
        <a href="/tags/php5">#php5</a>
      
        <a href="/tags/php4">#php4</a>
      
        <a href="/tags/php">#php</a>
      
        <a href="/tags/easyphp">#easyphp</a>
      
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2009/10/01/cakephp-deployment-with-mercurial-on-dreamhost/">
        cakePHP deployment with Mercurial on Dreamhost
      </a>
    </h1>

    <span class="post-date">01 Oct 2009</span>

    <p>I now use Mercurial on my daily work flow and have set up some methods on my
dev machine to ease the pain of installing mercurial and make it work on any
new webserver.</p>

<p>Here are some snippets that automate all that stuff. You may have to change
one thing or two to accomodate your own setup.</p>

<p>First, I create a custom <code>.bashrc</code> file that I will put on the webserver and
create into the following method :</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">hgInstall<span class="o">()</span> <span class="o">{</span>
 mkdir -p ~/.packages/src
 <span class="nb">cd</span> ~/.packages/src
 wget http://www.selenic.com/mercurial/release/mercurial-1.2.tar.gz
 tar xvzf mercurial-1.2.tar.gz
 <span class="nb">cd </span>mercurial-1.2
 python setup.py install --home<span class="o">=</span>~/.packages/
 <span class="nb">echo</span> -e <span class="s2">&quot;[ui]\nusername = Pixelastic &lt;tim@mailastic.com&gt;&quot;</span> &gt;&gt; ~/.hgrc
 <span class="nb">echo</span> -e <span class="err">&quot;</span><span class="o">[</span>extensions<span class="o">]</span><span class="se">\n</span>hgext/hbisect<span class="o">=</span>!<span class="se">\n</span>hgext.imerge<span class="o">=</span>! &gt;&gt; ~/.hgrc

 . ~/.hgrc
 <span class="nb">cd</span> ~/
 hg version
<span class="o">}</span>
</code></pre></div>
<p>Let me explain. I first create a directory to store the packages I will
download (in this example I will only download one package, but as I don&#39;t
like to have files all around my server, I just keep them in this place). I
will then download Mercurial 1.2 in this new directory, unzip it and install
it.</p>

<p>Next step is configuring the default user and correcting some bugs with
Dreamhost trying to load non-existing extensions (<code>hgext/hbisec</code>t and
<code>hgext.imerge</code>). As I&#39;ve made a change to <code>.hgrc</code>, I reload it and get back to
the default directory while displaying hg version.</p>

<p>That&#39;s almost done, I also have to edit the .bash_profile and add the
following lines</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nb">export </span><span class="nv">PYTHONPATH</span><span class="o">=</span>~/.packages/lib/python
<span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>~/.packages/bin:<span class="nv">$PATH</span>
</code></pre></div>
<p>Ok, so this method will download, install on configure Hg on the Dreamhost
server. That&#39;s all very well, but I had to manually setup the .bashrc, let&#39;s
see if we cannot automate that as well.</p>

<p>Now, I&#39;m editing my .zsh<em>aliases on my local machine (or your .bash</em>aliases if
you&#39;re using bash) to add the following method</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">dreamhost<span class="o">()</span> <span class="o">{</span>
 scp ~/Documents/Config/Dreamhost/.bashrc ~/Documents/Config/Dreamhost/.bash_profile <span class="nv">$1</span>:~/
 ssh <span class="nv">$1</span> <span class="s1">&#39;. ~/.bashrc&#39;</span>
 scp ~/.ssh/id_rsa.pub ~/Documents/Config/Dreamhost/.ssh/xpsfixe.pub <span class="nv">$1</span>:~/
 ssh <span class="nv">$1</span> <span class="s1">&#39;addKeys&#39;</span>
 scp ~/Documents/Config/Dreamhost/cakeClearCache.sh <span class="nv">$1</span>:~/
 ssh <span class="nv">$1</span> <span class="s1">&#39;chmod +x ~/cakeClearCache.sh&#39;</span>
 ssh <span class="nv">$1</span> <span class="s1">&#39;hgInstall&#39;</span>
 ssh <span class="nv">$1</span>
<span class="o">}</span>
</code></pre></div>
<p>Ok, so this one is a little more complex. You have to call this method with
one paremeter, being the user@domain credentials to connect to your Dreamhost
server. What it will do is upload (using ssh) files from your local machine to
the server and then apply some commands on the machine using ssh.</p>

<p>First it will upload both the local version .bashrc and .bash_profile that are
sitting on your dev machine and &quot;reload&quot; the .bashrc, allowing you to use the
previously defined hgInstall directly in the shell</p>

<p>Then, it will upload your ssh key(s) to the server and add them to the list of
allowed keys (more on that later, just skip the addKeys line for now.)</p>

<p>The next step is uploading (and giving the correct chmod) a special script
that will clear cakePHP cache (more on that later too)</p>

<p>And the final step is calling the previously explained hgInstall method. So
the only thing you have to do is put this method in your .zsh_aliases (and the
corresponding keys, .bashrc and scripts in their corresponding places) then
run dreamhost() and Hg will be installed on your server.</p>

<p>So now let me get back a little on the two details I skipped. The first is the
key stuff. What I&#39;m doing is uploading your ssh key(s) to the server and then
calling addKeys. It will authorize those keys to connect using ssh without
having to type login/pass on each request. Here is the addKeys code (you have
to put it in your .bashrc file and modify the filename to your own)</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">addKeys<span class="o">()</span> <span class="o">{</span>
 mkdir .ssh
 cat id_rsa.pub &gt;&gt; .ssh/authorized_keys
 cat xpsfixe.pub &gt;&gt; .ssh/authorized_keys
 rm id_rsa.pub
 rm xpsfixe.pub
 chmod go-w ~
 chmod 700 ~/.ssh
 chmod 600 ~/.ssh/authorized_keys
<span class="o">}</span>
</code></pre></div>
<p>It will basically create the .ssh dir and authorized_keys file with your keys
info. It will then delete the files and set the correct chmod.</p>

<p>And the second part was about that cache clearing thing. When you update your
app using Hg, you do not want to update the cache files created by Cake as
they contain filepath reference and are likely to be different between your
test and prod environment and would surely broke your whole app. So, you set
an ignore rule in the .hgignore about them like the following :</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">syntax:glob
app/tmp/cache/cake_*
app/tmp/cache/views/*.php
app/tmp/cache/models/cake_*
app/tmp/cache/persistent/cake_*
</code></pre></div>
<p>It does work fine almost all the time, but it sometimes lead to errors as the
cache is not regenerated between each hg update. Sometimes you have to alter a
model schema or the way a value is stored in cache and if you don&#39;t clear your
cache, it can yield to unexpected results as the data will be wrongly parsed
and used.</p>

<p>So what i did to avoid that was to create a script that will clear the cache
for you. Here is the code (you have to be inside the project dir for this to
work)</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nb">cd </span>app/tmp/cache
rm -f cake_*
rm -f views/*<span class="se">\.</span>php
rm -f models/cake_*
rm -f persistent/cake_*
<span class="nb">cd</span> ../../../
</code></pre></div>
<p>It will remove all the cache files generated by cake that could interfere
after an update. You just have to wrap thoses lines in a method in your
.bashrc (mine is called cakeClearCache) and execute it after each update or
when you have caching issues.</p>

<p>Well, I think you guessed that I did not stop here. Manually applying the
method after each update can be a little tedious. So I put the previous code
in a file named cakeClearCache.sh (you can spot that I uploaded this file in
the dreamhost() method earlie)r. I also added the following line to my
/project/.hg/hgrc on my server (if you don&#39;t have this file, just create it,
it&#39;s a project-based hg configuration file)</p>
<div class="highlight"><pre><code class="language-ini" data-lang="ini"><span class="k">[hooks]</span>
<span class="na">update</span> <span class="o">=</span> <span class="s">~/cakeClearCache.sh</span>
</code></pre></div>
<p>It means that everytime an hg update is done, the specified script is fired.
That&#39;s really fine for us, it means that cache will be cleared on each update.
Sounds good.</p>

<p>One last thing to do was creating the hgrc file automatically. That&#39;s why I
created the following method (add it to the .bashrc file in the server). It is
just a wrapper that will create the hgrc file after doing an hg init</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">hgInitStart<span class="o">()</span> <span class="o">{</span>
 hg init
 <span class="nb">echo</span> -e <span class="s2">&quot;[hooks]\nupdate = ~/cakeClearCache.sh&quot;</span> &gt;&gt; ./.hg/hgrc
<span class="o">}</span>
</code></pre></div>
<p>So instead of doing hg init, just do hgInitStart. You can then start cloning
your project here.</p>

<p>And one last thing, I also created a method that will set correct chmod to
app/tmp and app/webroot/files</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">cakeCorrectChmod<span class="o">()</span> <span class="o">{</span>
 chmod 777 ./app/tmp -R
 chmod 777 ./app/webroot/files -R
<span class="o">}</span>
</code></pre></div>
<p>And created a wrapper around it to call just after having cloned the project
that will update it and set the correct chmods</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">hgInitEnd<span class="o">()</span> <span class="o">{</span>
 hg update tip
 cakeCorrectChmod
<span class="o">}</span>
</code></pre></div>
<p>That&#39;s all. I bet anyone slightly more experienced in shell scripting could do
better than that, but as I have struggled a little to get this right I thought
I could share it.</p>


    <div class="tag-list">
      
        <a href="/tags/ssh">#ssh</a>
      
        <a href="/tags/mercurial">#mercurial</a>
      
        <a href="/tags/hg">#hg</a>
      
        <a href="/tags/dreamhost">#dreamhost</a>
      
        <a href="/tags/cakephp">#cakephp</a>
      
    </div>
  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page45">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page43">Newer</a>
    
  
</div>

  </div>

</body>

</html>
